<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
     <title>International Migration</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" /> 
    <link rel="stylesheet" href="css/population_maps_style.css" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Maven+Pro" rel="stylesheet">
    <link rel="stylesheet" href="css/perfect-scrollbar.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="shortcut icon" href="img/pnw.ico" type="image/x-icon">
    
    <meta property="og:title" content="Atlas of the Pacific Northwest: Immigration" />
    <meta property="og:url" content="https://rawgit.com/osulp/PNWatlas/master/population/immigration.html" />
    <meta property="og:description" content="Immigration maps of the Pacific Northwest."/>
    
    <script type="text/javascript" src="js/perfect-scrollbar.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>
    <script type="text/javascript" src="https://d3js.org/topojson.v1.min.js"></script>
    <script type="text/javascript" src="../js/clickFunction.js"></script>
    
    <link rel="stylesheet" href="../css/introjs.css" />
    <script src="../js/intro.js"></script>
   
</head>
<body>
	<button id="collapse" onclick="collapse()">
		<i class="fa fa-chevron-left" id ="collapse-arrow" aria-hidden="true"></i>
	</button>
    <div id="infoPanel">
			<div id="top">
				<h1 style="font-size:39px;">International Migration</h1>
				<img src="img/immigration_icon.png" id="titleImageCircle" style="display:inline-block;">
				<div id="buttons" data-step="1" data-intro="Use the dropdown menu to select different datasets for display.">
					<div class="dropdown">
						<button class="dropbtn"><b id="dataType">Select Region</b><p id="arrow">&#9660;</p></button>
						<div class="dropdown-content">
							 <button type="button" id="but1" class="selection" style="background:rgba(242, 242, 242, 0.8);">N Europe</button>
							 <button type="button" id="but2" class="selection">W Europe</button>
							 <button type="button" id="but3" class="selection">S Europe</button>
							 <button type="button" id="but4" class="selection">E Europe</button>
							 <button type="button" id="but5" class="selection">E Asia</button>
							 <button type="button" id="but6" class="selection">W Asia</button>
							 <button type="button" id="but7" class="selection">SE Asia</button>
							 <button type="button" id="but8" class="selection">S Asia</button>
							 <button type="button" id="but9" class="selection">E Africa</button>
							 <button type="button" id="but10" class="selection">C Africa</button>
							 <button type="button" id="but11" class="selection">N Africa</button>
							 <button type="button" id="but12" class="selection">S Africa</button>
							 <button type="button" id="but13" class="selection">W Africa</button>
							 <button type="button" id="but14" class="selection">Aust/NZ</button>
							 <button type="button" id="but15" class="selection">Oceania</button>
							 <button type="button" id="but16" class="selection">Caribbean</button>
							 <button type="button" id="but17" class="selection">C America</button>
							 <button type="button" id="but18" class="selection">S America</button>
							 <button type="button" id="but19" class="selection">Canada</button>
					   </div>
					</div>
				</div>
			</div>
			<div id="attribution">
				<div id="text" data-step="2" data-intro="Each dataset has a specific legend, displayed here.">
					<h2 id="title" style="display:block; width:280px; white-space:normal;">% Residents Born in Northern Europe</h2><img src="img/region_icons/north_europe.png" id="region" style="display:inline-block; right:0px;">
					<div style="height:32px;"><b id="leg1_block" style="background:#045a8d; border-left:black 2px solid; border-right:black 2px solid; border-top:black 2px solid;"></b><p id="leg1_value" style="margin-left:5px;">0.55+</p></div>
					<div style="height:30px;"><b id="leg2_block" style="background:#2b8cbe; border-left:black 2px solid; border-right:black 2px solid;"></b><p id="leg2_value" style="margin-left:5px;">0.4 to 0.55</p></div>
					<div style="height:30px;"><b id="leg3_block" style="background:#74a9cf; border-left:black 2px solid; border-right:black 2px solid;"></b><p id="leg3_value" style="margin-left:5px;">0.25 to 0.4</p></div>
					<div style="height:30px;"><b id="leg4_block" style="background:#bdc9e1; border-left:black 2px solid; border-right:black 2px solid;"></b><p id="leg4_value" style="margin-left:5px;">0.1 to 0.25</p></div>
					<div style="height:32px;"><b id="leg5_block" style="background:#f1eef6; border-left:black 2px solid; border-right:black 2px solid; border-bottom:black 2px solid;"></b><p id="leg5_value" style="margin-left:5px;">Less than 0.1</p></div>
					<p id="description" style="font-weight:bold; white-space:normal; padding-left:0px; width:280px; display:block; position:relative; padding-top:20px;">Residents born in Northern Europe as a percentage of total population</p>
					<div id="facts_1">
						<br/>
						<p3 style="font-weight:bold; line-height:36px;">Fast Facts:</p3><br/>
						<p3 id="facts">&#9900&nbspIt is estimated that 11% of all PNW residents were born outside the U.S.</p3><br/><br/>
						<p3 id="facts">&#9900&nbspOf all world regions, Central America has the largest immigrant population in the PNW.</p3><br/><br/>
					</div>
				</div>
				<div id="pageChange" data-step="3" data-intro="Use these buttons to view data sources, view other map pages, or share maps on social media.">
					<a href="#sources" id="arrow" style="display:inline-block;" title="Map Sources/Info">
						<i class="fa fa-info-circle" aria-hidden="true" style="padding-left:60px;"></i>
					</a>
					<a href="#link_popup" id="arrow" style="display:inline-block;" title="Other Maps">
						<i class="fa fa-home" aria-hidden="true" style="padding-left:7px;"></i>
					</a>
					<a href="#share" class="share" id="arrow" style="display:inline-block;" title="Share Map">
						<i class="fa fa-share-alt " aria-hidden="true" style="padding-left:7px;"></i>
					</a>
					<a class="share" id="arrow" style="display:inline-block;" href="javascript:void(0);" onclick="javascript:introJs().setOption('showBullets', false).setOption('showStepNumbers', false).setOption('tooltipClass', 'customDefault').start();" title="Map Demo">
						<i class="fa fa-question-circle " aria-hidden="true" style="padding-left:7px;"></i>
					</a>
				</div>
			</div>
	</div>
   <div id="map" style="width: 100%; height: 100%;" data-step="4" data-intro="This is the main map display. Hovering over counties to reveal more information."></div>
   
   		<div id="sources" class="overlay">
			<div class="popup">
				<h2 style="display:inline; font-size:32px;">Sources</h2>
				<a class="close" href="#" style="display:inline;">×</a>
				<hr>
				<div class="content">
					<p2 style="font-size:20px">Geographic Data</p2><br><br/>
                    <div class="source">
                    	<b><p2>Foreign Born Population: <a href = "https://factfinder.census.gov/faces/tableservices/jsf/pages/productview.xhtml?pid=ACS_15_SPT_B05006&prodType=table" target="_blank">United States Census Bureau</a></p2></b><br>
                    		<p3>ACS data from 2011-2015.</p3>
                    </div>
                    <p2 style="font-size:20px">Basemap</p2><br><br/>
                    	<div class="source">
                    		<b><p2>Background Terrain: <a href = "https://leaflet-extras.github.io/leaflet-providers/preview/index.html#filter=Esri.WorldTerrain" target="_blank">ESRI</a></p2></b><br>
                    			<p3>ESRI Background Terrain; Source: USGS, Esri, TANA, DeLorme, and NPS<p3>
                    	</div>
				</div>
				<hr>
				<p2 id="map_creation" style="float:right; font-size:16px;">Map created with <a href = "https://leafletjs.com/" target="_blank">Leaflet</a>, <a href = "https://d3js.org/topojson.v1.min.js" target="_blank">D3 TopoJson</a>, <a href = "http://geoserver.org/" target="_blank">Geoserver</a>, and <a href = "https://qgis.org/en/site/" target="_blank">QGIS</a></p2>
				<br/>
				<a class="close2" href="#" style="display:inline;">Close</a>
			</div>
		</div>
		
		<div id="link_popup" class="link_overlay">
			<div class="link_popup">
				<a class="close" href="#" style="display:inline;">×</a>
				<div class="content">
					<a href="population_index.html" style="font-weight:bold; text-decoration:none;">Population Home</a>
					<hr>
					<a href="demographics.html" style="text-decoration:underline;">Demographics</a>
					<a href="housing.html" style="text-decoration:underline;">Housing</a>
					<a href="migration.html" style="text-decoration:underline;">Internal Migration</a>
					<a href="urban_rural.html" style="text-decoration:underline;">Urban & Rural</a>
					<a href="immigration.html" style="text-decoration:underline;">Immigration</a>
					<hr>
					<a href="../index.html" style="font-weight:bold; text-decoration:none;">Atlas Home</a>
				</div>
			</div>
		</div>
		
		<div id="share" class="share_overlay">
			<div class="share_popup">
				<a id="clear" href="#" style="display:none;">×</a>
				<div class="content">
					<a href="https://facebook.com/sharer.php?u=https://rawgit.com/osulp/PNWatlas/master/population/immigration.html" id="arrow" style="display:inline-block;">
						<i class="fa fa-facebook-square " aria-hidden="true" style="padding-left:0;"></i>
					</a>
					<a href="https://twitter.com/home?status=PNW%20Immigration%0Ahttp%3A//rawgit.com/osulp/PNWatlas/master/population/immigration.html" id="arrow" style="display:inline-block;">
						<i class="fa fa-twitter-square " aria-hidden="true" style="padding-left:0;"></i>
					</a>
					<a href="" id="arrow" style="display:inline-block;">
						<i class="fa fa-linkedin-square " aria-hidden="true" style="padding-left:0;"></i>
					</a>
				</div>
			</div>
		</div>
<script>
//////////////base functions (these never change)///////////////////////
	//////////////function for the info panel collapse button/////////////////////// 
    var collapsed = false;
    function collapse(){
    	if (collapsed == false){
    		document.getElementById("infoPanel").style.transition = "display 2s";
    		document.getElementById("infoPanel").style.display = "none";
    		document.getElementById("collapse").style.left = '0px';
    		document.getElementById("collapse").style.paddingLeft = '2px';
    		document.getElementById("collapse-arrow").className = "fa fa-chevron-right";
    		collapsed = true;
    	} else{
    		document.getElementById("infoPanel").style.display = "unset";
    		document.getElementById("collapse").style.left = '320px';
    		document.getElementById("collapse").style.paddingLeft = '0px';
    		document.getElementById("collapse-arrow").className = "fa fa-chevron-left";
    		collapsed = false;
    	}
    	
    }
	//////////////function that allows topojson layers to be loaded///////////////////////
    L.TopoJSON = L.GeoJSON.extend({  
  		addData: function(jsonData) {    
    		if (jsonData.type === 'Topology') {
      			for (key in jsonData.objects) {
       			 geojson = topojson.feature(jsonData, jsonData.objects[key]);
       			 L.GeoJSON.prototype.addData.call(this, geojson);
      		}
    	}    
    	else {
      		L.GeoJSON.prototype.addData.call(this, jsonData);
    		}
  		}  
	});
//////////////Initialize map///////////////////////    
	var map = L.map('map', {center: [45.56, -121.75], zoom: 6, zoomControl:false});
///////////////////////make zoom level correspond to browser size////////////////////////////////
	window.addEventListener('load', function(event){
    	var width = document.documentElement.clientWidth;
    	
    	if (width < 1500 && width > 800) {
        	map.setView(new L.LatLng(45.56, -121.75), 6); 
    		}  else if (width > 1501) {
        	map.setView(new L.LatLng(45.56, -119.75), 7); 
        	} else {
        	map.setZoom(5);
        	}
	});
	
	map.setMaxBounds(map.getBounds());
////////////////////////////////basemap layers////////////////////////////////
    
	var Esri_WorldTerrain = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}', {
		attribution: 'Tiles &copy; Esri &mdash; Source: USGS, Esri, TANA, DeLorme, and NPS',
		maxZoom:10,
		minZoom:4,
		opacity:1
	}).addTo(map);
	
	var pnwCover = L.tileLayer.wms('http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_PNW_ATLAS/wms', {
		layers: 'baldricg_PNW_ATLAS:pnw_outline2_black',
        format: 'image/png',
		maxZoom:11,
		minZoom:5,
		opacity:0.3,
		transparent:true,
	}).addTo(map);
	
	var label = L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_only_labels/{z}/{x}/{y}@2x.png', {
		attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
		subdomains: 'abcd',
		maxZoom:10,
		minZoom:5,
		tileSize:256,
		bounds:[
			new L.LatLng(49.56,-125.25),
			new L.LatLng(40.5,-111.5)
		],
		pane:'labels'
	});	
	
	map.createPane('labels');
	map.getPane('labels').style.pointerEvents = 'none';
	map.getPane('labels').style.zIndex = 700;
	label.addTo(map);
	//labelMask.addTo(map);
	
////////////////////////////important variables//////////////////////    
    var colorValue = ['#f1eef6','#bdc9e1','#74a9cf','#2b8cbe','#045a8d'];
    var dataValue = [0.1,0.25,0.4,0.55];
    var data = 1;

////////////////////////////////info control in upper right////////////////////////////////	
	 var info = L.control();

	info.onAdd = function (map) {
    	this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
    	this.update();
    	return this._div;
	};
	
	info.update = function (feature) {
		function nullFinder(prop) {
			if (prop == null)
				{return 0;}
			else if (isNaN(prop) == true)
				{return 0;}
			else {return prop;}
		}
		function whichPopData(){
			return data == 1 ? nullFinder(feature.n_euro):
				data == 2 ? nullFinder(feature.w_euro):
				data == 3 ? nullFinder(feature.s_euro):
				data == 4 ? nullFinder(feature.e_euro):
				data == 5 ? nullFinder(feature.e_asia):
				data == 6 ? nullFinder(feature.w_asia):
				data == 7 ? nullFinder(feature.se_asia):
				data == 8 ? nullFinder(feature.sc_asia):
				data == 9 ? nullFinder(feature.e_africa):
				data == 10 ? nullFinder(feature.m_africa):
				data == 11 ? nullFinder(feature.n_africa):
				data == 12 ? nullFinder(feature.s_africa):
				data == 13 ? nullFinder(feature.w_africa):
				data == 14 ? nullFinder(feature.aust_nz):
				data == 15 ? nullFinder(feature.oceania):
				data == 16 ? nullFinder(feature.caribbean):
				data == 17 ? nullFinder(feature.c_america):
				data == 18 ? nullFinder(feature.s_america):
				data == 19 ? nullFinder(feature.canada):
					feature.n_euro;
		}
		function whichData(){
			return data == 1 ? nullFinder(((feature.n_euro/feature.population)*100).toFixed(2)):
				data == 2 ? nullFinder(((feature.w_euro/feature.population)*100).toFixed(2)):
				data == 3 ? nullFinder(((feature.s_euro/feature.population)*100).toFixed(2)):
				data == 4 ? nullFinder(((feature.e_euro/feature.population)*100).toFixed(2)):
				data == 5 ? nullFinder(((feature.e_asia/feature.population)*100).toFixed(2)):
				data == 6 ? nullFinder(((feature.w_asia/feature.population)*100).toFixed(2)):
				data == 7 ? nullFinder(((feature.se_asia/feature.population)*100).toFixed(2)):
				data == 8 ? nullFinder(((feature.sc_asia/feature.population)*100).toFixed(2)):
				data == 9 ? nullFinder(((feature.e_africa/feature.population)*100).toFixed(2)):
				data == 10 ? nullFinder(((feature.m_africa/feature.population)*100).toFixed(2)):
				data == 11 ? nullFinder(((feature.n_africa/feature.population)*100).toFixed(2)):
				data == 12 ? nullFinder(((feature.s_africa/feature.population)*100).toFixed(2)):
				data == 13 ? nullFinder(((feature.w_africa/feature.population)*100).toFixed(2)):
				data == 14 ? nullFinder(((feature.aust_nz/feature.population)*100).toFixed(2)):
				data == 15 ? nullFinder(((feature.oceania/feature.population)*100).toFixed(2)):
				data == 16 ? nullFinder(((feature.caribbean/feature.population)*100).toFixed(2)):
				data == 17 ? nullFinder(((feature.c_america/feature.population)*100).toFixed(2)):
				data == 18 ? nullFinder(((feature.s_america/feature.population)*100).toFixed(2)):
				data == 19 ? nullFinder(((feature.canada/feature.population)*100).toFixed(2)):
					feature.n_euro;
		}
		function whichRegion(){
			return data == 1 ? 'Northern European':
				data == 2 ? 'Western European':
				data == 3 ? 'Southern European':
				data == 4 ? 'Eastern European':
				data == 5 ? 'East Asian':
				data == 6 ? 'West Asian':
				data == 7 ? 'Southeast Asian':
				data == 8 ? 'South Asian':
				data == 9 ? 'East African':
				data == 10 ? 'Central African':
				data == 11 ? 'North African':
				data == 12 ? 'South African':
				data == 13 ? 'West African':
				data == 14 ? 'Australia/New Zealand':
				data == 15 ? 'Oceanian':
				data == 16 ? 'Caribbean':
				data == 17 ? 'Central American':
				data == 18 ? 'South American':
				data == 19 ? 'Canadian':
					'Northern Europen';

		}
			this._div.innerHTML = (feature ?
        		'<h2 style="margin:0; display:inline-block;">'+ feature.NAME +'</h2><br/>' + '<p3 style="display:inline;">Total Pop.: </p3><p3 style="display:inline; font-weight:bold;">' + feature.population + '</p3><br/><p3 style="display:inline;">' + whichRegion() + ' Pop.: </p3><p3 style="font-weight:bold; display:inline;">' + whichPopData() +'</p3><br/><p3 style="display:inline; font-weight:bold;">' + whichData() + '%</p3>'
       			:'<b style="font-size:24px;">Hover over Map</b>');
	};

	info.addTo(map);
////////////////////////////display layers//////////////////////
     ////////////////////////////immigration counties//////////////////////
    const counties = new L.TopoJSON();

	$.getJSON('assets/counties_foreign_born.json')
  		.done(addTopoData);

	function addTopoData(topoData) {  
  		counties.addData(topoData);
  		counties.addTo(map);
  		counties.eachLayer(handleLayer);
	}

	function handleLayer(layer){
        layer.setStyle({
          		radius: 4,
        		weight: 1,
        		opacity:0.8,
        		color: '#ffffff',
        		fillColor: setColor(whichData(layer.feature.properties)),
        		fillOpacity: 0.7
        });
        layer.on({
         	mouseover: highlight,
            mouseout: resetHighlight
        });
    }
    
     
    function setColor(value){
    	return value > dataValue[3] ? colorValue[4]:
    		value > dataValue[2] ? colorValue[3]:
    		value > dataValue[1] ? colorValue[2]:
    		value > dataValue[0] ? colorValue[1]:
    			colorValue[0];
    } 
  
    
	function whichData(props){
		return data == 1 ? (props.n_euro/props.population)*100:
			data == 2 ? (props.w_euro/props.population)*100:
			data == 3 ? (props.s_euro/props.population)*100:
			data == 4 ? (props.e_euro/props.population)*100:
			data == 5 ? (props.e_asia/props.population)*100:
			data == 6 ? (props.w_asia/props.population)*100:
			data == 7 ? (props.se_asia/props.population)*100:
			data == 8 ? (props.sc_asia/props.population)*100:
			data == 9 ? (props.e_africa/props.population)*100:
			data == 10 ? (props.m_africa/props.population)*100:
			data == 11 ? (props.n_africa/props.population)*100:
			data == 12 ? (props.s_africa/props.population)*100:
			data == 13 ? (props.w_africa/props.population)*100:
			data == 14 ? (props.aust_nz/props.population)*100:
			data == 15 ? (props.oceania/props.population)*100:
			data == 16 ? (props.caribbean/props.population)*100:
			data == 17 ? (props.c_america/props.population)*100:
			data == 18 ? (props.s_america/props.population)*100:
			data == 19 ? (props.canada/props.population)*100:
					props.n_euro;
	}	

	 function highlight() {
		 this.setStyle({
        	fillOpacity: 1,
        	color:'#ffffff',
        	opacity:1
    	 });
    	info.update(this.feature.properties);
    }
    
    function resetHighlight() {
		this.setStyle({
        	fillOpacity: 0.7,
        	opacity:0.8
    	 });
		info.update();
	}
	
///////////////////////////////button function////////////////////////////////	  	
  	//this function uses the ClickFunction plugin to easily add/remove layers, change legends, styling and anything else when a new dataset is selected from the dropdown buttons  		
  	var buttonLabels = ['#but1','#but2','#but3','#but4','#but5','#but6','#but7','#but8','#but9','#but10','#but11','#but12','#but13','#but14','#but15','#but16','#but17','#but18','#but19'];

	var buttonFunctions = {
		but1: {button:'but1', topoLayers:[counties], topoHandler:[handleLayer], title:'Northern Europe', legendTitle:'% Residents Born in Northern Europe', imageSRC:"img/region_icons/north_europe.png", variable:1, values:[0.1,0.25,0.4,0.55], colors:['#f1eef6','#bdc9e1','#74a9cf','#2b8cbe','#045a8d'],legendDescription:"Residents born in Northern Europe as a percentage of total population", legendValue:["Less than 0.10", "0.10 - 0.25","0.25 - 0.40","0.40 - 0.55","0.55+"]},
		but2: {button:'but2', topoLayers:[counties], topoHandler:[handleLayer], title:'Western Europe', legendTitle:'% Residents Born in Western Europe', imageSRC:"img/region_icons/west_europe.png", variable:2, values:[0.1,0.25,0.4,0.55], colors:['#f2f0f7','#cbc9e2','#9e9ac8','#756bb1','#54278f'],legendDescription:"Residents born in Western Europe as a percentage of total population", legendValue:["Less than 0.10", "0.10 - 0.25","0.25 - 0.40","0.40 - 0.55","0.55+"]},
		but3: {button:'but3', topoLayers:[counties], topoHandler:[handleLayer], title:'Southern Europe', legendTitle:'% Residents Born in Southern Europe', imageSRC:"img/region_icons/south_europe.png", variable:3, values:[0.01,0.05,0.1,0.2], colors:['#edf8e9','#bae4b3','#74c476','#31a354','#006d2c'],legendDescription:"Residents born in Southern Europe as a percentage of total population", legendValue:["Less than 0.01", "0.01 - 0.05","0.05 - 0.10","0.10 - 0.20","0.20+"]},
		but4: {button:'but4', topoLayers:[counties], topoHandler:[handleLayer], title:'Eastern Europe', legendTitle:'% Residents Born in Eastern Europe', imageSRC:"img/region_icons/east_europe.png", variable:4, values:[0.1,0.25,0.5,1], colors:['#fee5d9','#fcae91','#fb6a4a','#de2d26','#a50f15'], legendDescription:"Residents born in Eastern Europe as a percentage of total population", legendValue:["Less than 0.10", "0.1 - 0.25","0.25 - 0.50","0.50 - 1","1+"]},
		but5: {button:'but5', topoLayers:[counties], topoHandler:[handleLayer], title:'East Asia', legendTitle:'% Residents Born in East Asia', imageSRC:"img/region_icons/east_asia.png", variable:5, values:[0.2,0.5,1,2], colors:['#f2f0f7','#cbc9e2','#9e9ac8','#756bb1','#54278f'], legendDescription:"Residents born in East Asia as a percentage of total population", legendValue:["Less than 0.20", "0.20 - 0.50","0.50 - 1","1 - 2","2+"]},
		but6: {button:'but6', topoLayers:[counties], topoHandler:[handleLayer], title:'West Asia', legendTitle:'% Residents Born in West Asia', imageSRC:"img/region_icons/west_asia.png", variable:6, values:[0.01,0.1,0.2,0.5], colors:['#f1eef6','#bdc9e1','#74a9cf','#2b8cbe','#045a8d'], legendDescription:"Residents born in West Asia as a percentage of total population", legendValue:["Less than 0.01", "0.01 - 0.10","0.10 - 0.20","0.20 - 0.50","0.50+"]},
		but7: {button:'but7', topoLayers:[counties], topoHandler:[handleLayer], title:'Southeast Asia', legendTitle:'% Residents Born in Southeast Asia', imageSRC:"img/region_icons/southeast_asia.png", variable:7, values:[0.2,0.5,1,2.5], colors:['#edf8e9','#bae4b3','#74c476','#31a354','#006d2c'], legendDescription:"Residents born in Southeast Asia as a percentage of total population", legendValue:["Less than 0.20", "0.20 - 0.50","0.50 - 1","1 - 2.50","2.50+"]},
		but8: {button:'but8', topoLayers:[counties], topoHandler:[handleLayer], title:'South/Central Asia', legendTitle:'% Residents Born in South/Central Asia', imageSRC:"img/region_icons/south_asia.png", variable:8, values:[0.01,0.1,0.2,0.5], colors:['#fee5d9','#fcae91','#fb6a4a','#de2d26','#a50f15'], legendDescription:"Residents born in South/Central Asia as a percentage of total population", legendValue:["Less than 0.01", "0.01 - 0.10","0.10 - 0.20","0.20 - 0.50","0.50+"]},
		but9: {button:'but9', topoLayers:[counties], topoHandler:[handleLayer], title:'East Africa', legendTitle:'% Residents Born in East Africa', imageSRC:"img/region_icons/east_africa.png", variable:9, values:[0.01,0.05,0.1,0.2], colors:['#f1eef6','#bdc9e1','#74a9cf','#2b8cbe','#045a8d'], legendDescription:"Residents born in East Africa as a percentage of total population", legendValue:["Less than 0.01", "0.01 - 0.05","0.05 - 0.10","0.10 - 0.20","0.20+"]},
		but10: {button:'but10', topoLayers:[counties], topoHandler:[handleLayer], title:'Central Africa', legendTitle:'% Residents Born in Central Africa', imageSRC:"img/region_icons/central_africa.png", variable:10, values:[0.01,0.05,0.1,0.2], colors:['#edf8e9','#bae4b3','#74c476','#31a354','#006d2c'], legendDescription:"Residents born in Central Africa as a percentage of total population", legendValue:["Less than 0.01", "0.01 - 0.05","0.05 - 0.10","0.10 - 0.20","0.20+"]},
		but11: {button:'but11', topoLayers:[counties], topoHandler:[handleLayer], title:'North Africa', legendTitle:'% Residents Born in North Africa', imageSRC:"img/region_icons/north_africa.png", variable:11, values:[0.01,0.02,0.05,0.1], colors:['#fee5d9','#fcae91','#fb6a4a','#de2d26','#a50f15'], legendDescription:"Residents born in North Africa as a percentage of total population", legendValue:["Less than 0.01", "0.01 - 0.02","0.02 - 0.05","0.05 - 0.10","0.10+"]},
		but12: {button:'but12', topoLayers:[counties], topoHandler:[handleLayer], title:'South Africa', legendTitle:'% Residents Born in South Africa', imageSRC:"img/region_icons/south_africa.png", variable:12, values:[0.01,0.025,0.05,0.1], colors:['#f2f0f7','#cbc9e2','#9e9ac8','#756bb1','#54278f'], legendDescription:"Residents born in South Africa as a percentage of total population", legendValue:["Less than 0.01", "0.01 - 0.025","0.025 - 0.05","0.05 - 0.10","0.10+"]},
		but13: {button:'but13', topoLayers:[counties], topoHandler:[handleLayer], title:'West Africa', legendTitle:'% Residents Born in West Africa', imageSRC:"img/region_icons/west_africa.png",variable:13, values:[0.01,0.05,0.1,0.25], colors:['#f3f3f3','#f9f6b1','#febb72','#fe9b64','#ff776c'], legendDescription:"Residents born in West Africa as a percentage of total population", legendValue:["Less than 0.01", "0.01 - 0.05","0.05 - 0.10","0.10 - 0.25","0.25+"]},
		but14: {button:'but14', topoLayers:[counties], topoHandler:[handleLayer], title:'Australia/New Zealand', legendTitle:'% Residents Born in Australia/New Zealand', imageSRC:"img/region_icons/australia.png", variable:14, values:[0.01,0.05,0.1,0.2], colors:['#f1eef6','#bdc9e1','#74a9cf','#2b8cbe','#045a8d'], legendDescription:"Residents born in Australia/New Zealand as a percentage of total population", legendValue:["Less than 0.01", "0.01 - 0.05","0.05 - 0.10","0.10 - 0.20","0.20+"]},
		but15: {button:'but15', topoLayers:[counties], topoHandler:[handleLayer], title:'Oceania', legendTitle:'% Residents Born in Oceania/Pacific Islands', imageSRC:"img/region_icons/oceania.png", variable:15, values:[0.01,0.05,0.1,0.25], colors:['#fee5d9','#fcae91','#fb6a4a','#de2d26','#a50f15'], legendDescription:"Residents born in Oceania as a percentage of total population", legendValue:["Less than 0.01", "0.01 - 0.05","0.05 - 0.10","0.10 - 0.25","0.25+"]},
		but16: {button:'but16', topoLayers:[counties], topoHandler:[handleLayer], title:'Caribbean', legendTitle:'% Residents Born in Caribbean', imageSRC:"img/region_icons/caribbean.png", variable:16, values:[0.01,0.05,0.1,0.2], colors:['#f1eef6','#bdc9e1','#74a9cf','#2b8cbe','#045a8d'], legendDescription:"Residents born in Caribbean as a percentage of total population", legendValue:["Less than 0.01", "0.01 - 0.05","0.05 - 0.10","0.10 - 0.20","0.20+"]},
		but17: {button:'but17', topoLayers:[counties], topoHandler:[handleLayer], title:'Central America', legendTitle:'% Residents Born in Central America', imageSRC:"img/region_icons/central_america.png", variable:17, values:[0.5,1,5,10], colors:['#fee5d9','#fcae91','#fb6a4a','#de2d26','#a50f15'], legendDescription:"Residents born in Central America as a percentage of total population", legendValue:["Less than 0.50", "0.50 - 1","1 - 5","5 - 10","10+"]},
		but18: {button:'but18', topoLayers:[counties], topoHandler:[handleLayer], title:'South America', legendTitle:'% Residents Born in South America', imageSRC:"img/region_icons/south_america.png", variable:18, values:[0.1,0.2,0.4,0.6], colors:['#edf8e9','#bae4b3','#74c476','#31a354','#006d2c'], legendDescription:"Residents born in South America as a percentage of total population", legendValue:["Less than 0.10", "0.10 - 0.20","0.20 - 0.40","0.40 - 0.60","0.60+"]},
		but19: {button:'but19', topoLayers:[counties], topoHandler:[handleLayer], title:'Canada', legendTitle:'% Residents Born in Canada/North America', imageSRC:"img/region_icons/canada.png", variable:19, values:[0.2,0.4,0.6,0.8], colors:['#fee5d9','#fcae91','#fb6a4a','#de2d26','#a50f15'], legendDescription:"Residents born in Canada as a percentage of total population", legendValue:["Less than 0.20", "0.20 - 0.40","0.40 - 0.60","0.60 - 0.80","0.80+"]}	
	};
	
	$('.func').clickFunction({
		buttonFunctions: buttonFunctions,
		buttonLabels: buttonLabels,
		imageDiv:'region',
		legendUpdate: true,
		selected:buttonFunctions.but1
	});
 
 ///////////////////////////////other miscellaneous functions (these also never change)////////////////////////////////    
    new L.Control.Zoom({ position: 'bottomright' }).addTo(map);
	document.getElementsByClassName("leaflet-control-attribution")[0].style.visibility = "hidden";
	//add scrolling capabilities to text box
     var container = document.getElementById('text');
		Ps.initialize(container);
	
	var minHeight = 30; // Define a minimum height for the middle div

	function resizeMiddle() {
    var h = $('body').height() - $('#top').height() - 65;
    		h = h > minHeight ? h : minHeight;
   	 	$('#attribution').height(h);
	}
	
	function resizePopup() {
   		var h = $('.popup').height() - 90;
    		h = h > minHeight ? h : minHeight;
   	 	$('.popup .content').height(h);
	}
	$(document).ready(resizePopup);
	$(window).resize(resizePopup);

	$(document).ready(resizeMiddle);
	$(window).resize(resizeMiddle);
	
    $(document).click(function(event) {
		if (!$(event.target).closest(".share_overlay,.share,#sources,#link_popup").length) {
			$('#clear')[0].click();
		}
	});


</script>
</body>
</html>
