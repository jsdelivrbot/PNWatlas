<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
     <title>Water Use</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" /> 
    <link rel="stylesheet" href="css/water_use_style.css" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Maven+Pro" rel="stylesheet">
    <link rel="stylesheet" href="css/perfect-scrollbar.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="shortcut icon" href="img/pnw.ico" type="image/x-icon">
    
    <script src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="js/perfect-scrollbar.js"></script>
    
   
</head>
<body>
		<div id="infoPanel">
			<div id="top">
			<h1>Water Use</h1>
			<div id="buttons">
				<div class="dropdown">
  					<button class="dropbtn">Select Use<p id="arrow">&#9660;</p></button>
  						<div class="dropdown-content">
  							<button type="button" id="but1" onclick="totalFunc()" style="float:left; background:rgba(242, 242, 242, 0.67);" class="selection">Total</button>
							<button type="button" id="but2" onclick="publicFunc()" class="selection" style="float:left;">Public</button>
							<button type="button" id="but3" onclick="domesticFunc()" style="float:left;" class="selection">Domestic</button>
							<button type="button" id="but4" onclick="industrialFunc()" class="selection" style="float:left;">Industrial</button>
							<button type="button" id="but5" onclick="thermoFunc()" style="float:left;" class="selection">Thermoelectric</button>
							<button type="button" id="but6" onclick="miningFunc()" style="float:left;" class="selection">Mining</button>
							<button type="button" id="but7" onclick="livestockFunc()" style="float:left;" class="selection">Livestock</button>
							<button type="button" id="but8" onclick="irrigationFunc()" style="float:left;" class="selection">Irrigation</button>
							<button type="button" id="but9" onclick="aquaFunc()" style="float:left;" class="selection">Aquaculture</button>
  						</div>
  				</div>
  				<div class="dropdown">
  					<button class="dropbtn">Select Water<p id="arrow">&#9660;</p></button>
  						<div class="dropdown-content">
  							<button type="button" id="total" onclick="totalWaterFunc()" class="selection" style="background:rgba(242, 242, 242, 0.8);">Total</button>
  							<button type="button" id="surface" onclick="surfaceFunc()" class="selection">Surface Water</button>
  							<button type="button" id="ground" onclick="groundFunc()" class="selection">Groundwater</button>
  						</div>
  				</div>
			</div>
			<h2 id="title" style="display:inline-block; width:280px; white-space:normal;">Total Water Use (Mgal/day)</h2><img src="img/total.png" id="image" style="display:inline-block; float:right;">
			<br>
			<b id ="highest" style="background:#045a8d; border-left:black 2px solid; border-right:black 2px solid; border-top:black 2px solid;"></b><p>&nbsp</p><p id="leg1">1000+</p><br/>
			<b id ="midhigh" style="background:#2b8cbe; border-left:black 2px solid; border-right:black 2px solid;"></b><p>&nbsp</p><p id="leg2">500 - 1000</p><br/>
			<b id ="middle" style="background:#74a9cf; border-left:black 2px solid; border-right:black 2px solid;"></b><p>&nbsp</p><p id="leg3">250 - 500</p><br/>
			<b id ="midlow" style="background:#bdc9e1; border-left:black 2px solid; border-right:black 2px solid;"></b><p>&nbsp</p><p id="leg4">100 - 250</p><br/>
			<b id ="lowest" style="background:#f1eef6; border-left:black 2px solid; border-right:black 2px solid;"></b><p>&nbsp</p><p id="leg5">Less than 100</p><br/>
			<b style="background:#ffffff; border-left:black 2px solid; border-right:black 2px solid; border-bottom:black 2px solid;"></b><p>&nbsp</p><p id="leg5">0 or No Data</p><br/><br/>
			<p id="description" style="font-weight:bold; padding:0; display:inline-block; white-space:normal; width:280px; position:relative;">Water use in millions of gallons of water per day.</p>
			</div>
			<div id="attribution">
				<div id="text" style="margin-top:15px;">
					<p3>The U.S. Geological Survey's National Water-Use Science Project is responsible for compiling and disseminating the nation's water-use data. The USGS works in cooperation with local, State, and Federal environmental agencies to collect water-use information. USGS compiles these data to produce water-use information aggregated at the county, state, and national levels. Every five years, data at the county level are compiled into a national water-use data system and state-level data are published in a national circular. Over the history of these circulars, the water-use categories have had some changes. The USGS Water-Use Data and Research program seeks to develop improved water-use data through agreements with State water-resources agencies.</p3>
				</div>
				<br/>
			</div>
			<div id="pageChange">
				<a href="pollution_index.html" id="arrow" style="display:inline-block;">
					<i class="fa fa-arrow-left" aria-hidden="true" style=""></i>
				</a>
				<a href="source_index.html" id="arrow" style="display:inline-block;" target="_blank">
					<i class="fa fa-info-circle" aria-hidden="true" style="margin-left:83px;"></i>
				</a>
				<a href="water_index.html" id="arrow" style="display:inline-block;" target="_blank">
					<i class="fa fa-home" aria-hidden="true"></i>
				</a>
				<a href="groundwater_index.html" id="arrow" style="display:inline-block;">
					<i class="fa fa-arrow-right" aria-hidden="true" style="margin-left:82px;"></i>
				</a>
			</div>
		</div>
    	<div id="map" style="width: 100%; height: 100%;"></div>
<script>
	//initialize map
	var map = L.map('map', {center: [45.56, -119.75], zoom: 7, zoomControl:false});
	///////////////////////make zoom level correspond to browser size////////////////////////////////
	window.addEventListener('load', function(event){
    	var width = document.documentElement.clientWidth;
    	if (width < 1500 && width > 800) {
        	map.setView(new L.LatLng(45.56, -121.75), 6); 
    		}  else if (width > 1501) {
        	map.setZoom(7);
        	} else {
        	map.setZoom(5);
        	}
        update();
	});
	////////////////////////////////add tiled basemap////////////////////////////////
	var Esri_WorldTerrain = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}', {
		attribution: 'Tiles &copy; Esri &mdash; Source: USGS, Esri, TANA, DeLorme, and NPS',
		maxZoom:8,
		minZoom:4
	}).addTo(map);
	
	var label = L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_only_labels/{z}/{x}/{y}.png', {
		attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
		subdomains: 'abcd',
		maxZoom:8,
		minZoom:5,
		opacity:0.7,
		pane:'labels'
	});	
	var labelMask = L.tileLayer.wms('http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_PNW_ATLAS/wms', {
		layers: 'baldricg_PNW_ATLAS:label_mask',
        format: 'image/png',
		maxZoom:8,
		minZoom:5,
		opacity:1,
		transparent:true,
		pane: 'labels'
	});
	map.createPane('labels');
	map.getPane('labels').style.pointerEvents = 'none';
	map.getPane('labels').style.zIndex = 650;
	label.addTo(map);
	labelMask.addTo(map);
	
	//changes depending on which data type is selected, initial value is for County Employment
	var data = 0;
	var water = 0;
	//used with DATA variable to select data type corresponding to each button. Odd numbered buttons correspond to state-level data
	var buttonNumber = ['but1','but2','but3','but4','but5','but6','but7','but8','but9'];
	

    ///////////////////////////////////////////////////////////////////////////////////////	
    var info = L.control();

	info.onAdd = function (map) {
    	this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
    	this.update();
    	return this._div;
	};
	
	info.update = function (feature) {
	//detects whether or not a value is null
		function nullFinder() {
			if (dataType(feature) == null)
				{return 'N/A';}
			else if (isNaN(dataType(feature)) == true)
				{return 0.00;}
			else {return dataType(feature);}
		}
	//determines which icon to display next to the name
		function whichImage() {
			return data == 0 ? '<img src="img/totalEmp.png" id="image3" style="display:inline-block; width:30px; height:30px; position:relative; left:15px; top:10px;"><br/>':
    		 	data == 1 ? '<img src="img/spend.png" id="image3" style="display:inline-block; width:30px; height:30px; position:relative; left:15px; top:10px;"><br/>':
    		 	data == 2 ? '<img src="img/wages.png" id="image3" style="display:inline-block; width:30px; height:30px; position:relative; left:15px; top:10px;"><br/>':
    		 	data == 3 ? '<img src="img/tax.png" id="image3" style="display:inline-block; width:30px; height:30px; position:relative; left:15px; top:10px;"><br/>':
    		 	data == 4 ? '<img src="img/totalLocalEmp.png" id="image3" style="display:inline-block; width:30px; height:30px; position:relative; left:15px; top:10px;"><br/>':
    		 	data == 5 ? '<img src="img/localEmp.png" id="image3" style="display:inline-block; width:30px; height:30px; position:relative; left:15px; top:10px;"><br/>':
    		 	data == 6 ? '<img src="img/wages.png" id="image3" style="display:inline-block; width:30px; height:30px; position:relative; left:15px; top:10px;"><br/>':
    		 		'<img src="img/tree.png" id="image3" style="display:inline-block; width:30px; height:30px; position:relative; left:15px; top:10px;"><br/>';
    		}
    //actual info display information
   		this._div.innerHTML = (feature ?
       		'<b>' + feature.properties.NAME + ' County</b><br/><b id="displayType" style="display:inline;">' + nullFinder() + '&nbspMgal/day</b><br/>'
        		: '<b>Hover over map</b>');
		};

	info.addTo(map);
	
    ///////////////////////////////////////////////////////////////////////////////////////	
    
    ////////////////////////////////initial geoJSON styling////////////////////////////////
    
    //symbol levels
    var stateLevels = [1000, 500, 250, 100, 500, 250, 100, 50, 250, 100, 50, 10];
    var dataSelection = [0, 1, 2, 3];
    var colors = ['#045a8d','#2b8cbe','#74a9cf','#bdc9e1','#f1eef6'];
	//connect color ramp to symbol levels, null values and zeros are shown in white
	function setColor(density){
        return density > stateLevels[dataSelection[0]] ? colors[0] :
            density > stateLevels[dataSelection[1]] ? colors[1] :
            density > stateLevels[dataSelection[2]] ? colors[2] :
            density > stateLevels[dataSelection[3]] ? colors[3] :
            density == null ? '#ffffff' :
            isNaN(density) ? '#ffffff' :
            density == 0 ? '#ffffff' :
            density == -1 ? '#ffffff' :
                colors[4];
    	}
    
    
    //style function 
	function dataType(feature){
		if (water == 0){
			return data == 0 ? feature.properties.tot_use:
    		 	data == 1 ? feature.properties.tot_pub:
    		 	data == 2 ? feature.properties.tot_dom:
    		 	data == 3 ? feature.properties.tot_ind:
    		 	data == 4 ? feature.properties.tot_therm:
    		 	data == 5 ? feature.properties.tot_mine:
    		 	data == 6 ? feature.properties.tot_live:
    		 	data == 7 ? feature.properties.tot_irr:
    		 		feature.properties.tot_aqua;
		}
		else if (water == 1){
			return data == 0 ? feature.properties.SW_use:
    		 	data == 1 ? feature.properties.SW_pub:
    		 	data == 2 ? feature.properties.SW_dom:
    		 	data == 3 ? feature.properties.SW_ind:
    		 	data == 4 ? feature.properties.SW_therm:
    		 	data == 5 ? feature.properties.SW_mine:
    		 	data == 6 ? feature.properties.SW_live:
    		 	data == 7 ? feature.properties.SW_irr:
    		 		feature.properties.SW_aqua;
		}
		else {
			return data == 0 ? feature.properties.GW_use:
    		 	data == 1 ? feature.properties.GW_pub:
    		 	data == 2 ? feature.properties.GW_dom:
    		 	data == 3 ? feature.properties.GW_ind:
    		 	data == 4 ? feature.properties.GW_therm:
    		 	data == 5 ? feature.properties.GW_mine:
    		 	data == 6 ? feature.properties.GW_live:
    		 	data == 7 ? feature.properties.GW_irr:
    		 		feature.properties.GW_aqua;
		}
	}

	function waterStyle(feature) {
        		return {
            		fillColor: setColor(dataType(feature)),
            		fillOpacity: 0.7,
            		weight: 1,
            		opacity: 1,
            		color: '#ffffff',
        		};
    		}
	
	//highlight feature function
	function highlight(e) {
		 var layer = e.target;
		 layer.setStyle({
        	fillOpacity: 1,
        	color:'#ffffff',
        	dashArray: 4
    	 });
    	 layer.bringToFront();
		 info.update(layer.feature);
		}
	
	//reset feature function
	function resetHighlight(e) {
		 water_use.resetStyle(e.target);
		 info.update();
	}
	
	//add geoJSON to map
	var	water_use;
	
	function update() {
		water_use = $.getJSON("assets/water_use.geojson", function(data){
        		water_use = L.geoJson(data, {
        			style:waterStyle,
        			onEachFeature: function(feature, featureLayer) {
        				featureLayer.on({
        					mouseover: highlight,
        					mouseout: resetHighlight,
   						});
   						featureLayer.bindPopup('<b>'+ dataType(feature) +'&nbspMgal/day</b>', {className: 'label_tooltip'});
        		}
       		 }).addTo(map);
    	});
    }
	//////////////////////////////////////////////////////////////////////////////
	
	///////////////////////////////add outline layers////////////////////////////////
	function outlineStyle(){
	return{
		opacity: 0,
		fillOpacity:1,
		fillColor:'#000000'
		};
	}
    var	pnwOutline = $.getJSON("assets/pnw_boundary.geojson", function(data){
        pnwOutline = L.geoJson(data, {
        	style:outlineStyle
        }).addTo(map);
    });
	//////////////////////////////////////////////////////////////////////////////
    
 //////////////////////////////////////////////////////////////////////
     function titleText(){
     	function titleTextWater(){
     		return water == 0 ? "Water Use (Mgal/day)":
     			water == 1 ? "Surface Water Use (Mgal/day)":
     				"Groundwater Use (Mgal/day)";
    	 }
     	function titleTextUse(){
     		return data == 0 ? "Total&nbsp":
     			data == 1 ? "Public&nbsp":
     			data == 2 ? "Domestic&nbsp":
     			data == 3 ? "Industrial&nbsp":
     			data == 4 ? "Thermoelectric&nbsp":
     			data == 5 ? "Mining&nbsp":
     			data == 6 ? "Livestock&nbsp":
     			data == 7 ? "Irrigation&nbsp":
    				"Aquaculture&nbsp";
    	 }
    	 return titleTextUse() + titleTextWater();
     }
      function totalWaterFunc() {
    	map.removeLayer(water_use);
    	document.getElementById('surface').style.background = "rgba(242,242,242,0.2)";
    	document.getElementById('ground').style.background = "rgba(242,242,242,0.2)";
    	dataSelection = [0, 1, 2, 3];
    	water = 0;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('total').style.background = "rgba(242, 242, 242, 1)";
    	legend();
    	update();
    }
    function surfaceFunc() {
    	map.removeLayer(water_use);
    	document.getElementById('total').style.background = "rgba(242,242,242,0.2)";
    	document.getElementById('ground').style.background = "rgba(242,242,242,0.2)";
    	dataSelection = [4, 5, 6, 7];
    	water = 1;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('surface').style.background = "rgba(242, 242, 242, 1)";
    	legend();
    	update();
    }
    function groundFunc() {
    	map.removeLayer(water_use);
    	document.getElementById('total').style.background = "rgba(242,242,242,0.2)";
    	document.getElementById('surface').style.background = "rgba(242,242,242,0.2)";
    	dataSelection = [8, 9, 10, 11];
    	water = 2;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('ground').style.background = "rgba(242, 242, 242, 1)";
    	legend();
    	update();
    }
    
    ///////////////////////////////update data functions, used when users choose between state and county level data////////////////////////////////
    
	//employment by state
    function totalFunc() {
    	map.removeLayer(water_use);
    	document.getElementById(buttonNumber[data]).style.background = "rgba(242,242,242,0.2)";
    	colors = ['#045a8d','#2b8cbe','#74a9cf','#bdc9e1','#f1eef6'];
    	stateLevels = [1000, 500, 250, 100, 500, 250, 100, 50, 250, 100, 50, 10];
    	data = 0;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('description').innerHTML = "% of population employed in outdoor recreation";
    	document.getElementById('but1').style.background = "rgba(242, 242, 242, 1)";
    	document.getElementById("image").src = "img/total.png";
    	document.getElementById('description').innerHTML = "Water use in millions of gallons of water per day.";
		legend();
		update();
    }  
    //spending by state
    function publicFunc() {
    	map.removeLayer(water_use);
    	document.getElementById(buttonNumber[data]).style.background = "rgba(242,242,242,0.2)";
    	colors = ['#a50f15','#de2d26','#fb6a4a','#fcae91','#fee5d9'];
    	stateLevels = [50, 25, 10, 5, 25, 10, 5, 2.5, 25, 10, 5, 2.5];
    	data = 1;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('but2').style.background = "rgba(242, 242, 242, 1)";
    	document.getElementById('description').innerHTML = "Per capita outdoor recreation spending in dollars";
    	document.getElementById("image").src = "img/public.png";
    	document.getElementById('description').innerHTML = "Public self-supplied water use in millions of gallons of water per day. Includes deliveries to domestic users.";
    	legend();
    	update();
    }
    //wages by state
    function domesticFunc() {
    	map.removeLayer(water_use);
    	document.getElementById(buttonNumber[data]).style.background = "rgba(242,242,242,0.2)";
    	colors = ['#006837','#31a354','#78c679','#c2e699','#ffffcc'];
    	stateLevels = [10, 5, 2.5, 1, 0.5, 0.25, 0.1, 0.05, 10, 5, 2.5, 1];
    	data = 2;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('description').innerHTML = "Average annual outdoor recreation wages in thousands of dollars";
    	document.getElementById('but3').style.background = "rgba(242, 242, 242, 1)";
    	document.getElementById("image").src = "img/domestic.png";
    	document.getElementById('description').innerHTML = "Domestic self-supplied water use in millions of gallons of water per day. Does not include deliveries from public water providers.";
    	legend();
    	update();
    }
    //taxes by state
     function industrialFunc() {
    	map.removeLayer(water_use);
    	document.getElementById(buttonNumber[data]).style.background = "rgba(242,242,242,0.2)";
    	colors = ['#993404','#d95f0e','#fe9929','#fed98e','#fdedce'];
    	stateLevels = [25, 10, 5, 2.5, 25, 10, 5, 2.5, 5, 2.5, 1, 0.5];
    	data = 3;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('description').innerHTML = "Per capita outdoor recreation tax revenue in dollars";
    	document.getElementById('but4').style.background = "rgba(242, 242, 242, 1)";
    	document.getElementById("image").src = "img/industry.png";
    	document.getElementById('description').innerHTML = "Industrial self-supplied water use in millions of gallons of water per day.";
    	legend();
    	update();
    }
    //employment by county
    function thermoFunc() {
    	map.removeLayer(water_use);
    	document.getElementById(buttonNumber[data]).style.background = "rgba(242,242,242,0.2)";
    	colors = ['#810f7c','#8856a7','#8c96c6','#b3cde3','#edf8fb'];
    	stateLevels = [20, 10, 5, 1, 20, 10, 5, 1, 1, 0.75, 0.5, 0.25];
    	data = 4;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('description').innerHTML = "% of population employed in outdoor recreation";
    	document.getElementById('but5').style.background = "rgba(242, 242, 242, 1)";
    	document.getElementById("image").src = "img/thermo.png";
    	document.getElementById('description').innerHTML = "Self-supplied water use for thermoelectricity in millions of gallons of water per day.";
    	legend();
    	update();
    }
    //employment in local government by county
    function miningFunc() {
    	map.removeLayer(water_use);
    	document.getElementById(buttonNumber[data]).style.background = "rgba(242,242,242,0.2)";
    	colors = ['#734d26','#9e6934','#c48a4e','#d8b18a','#ecd9c6'];
    	stateLevels = [2.5, 1, 0.5, 0.25, 1, 0.5, 0.25, 0.1, 1, 0.5, 0.25, 0.1];
    	data = 5;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('description').innerHTML = "% of population employed in local government parks & recreation organizations";
    	document.getElementById('but6').style.background = "rgba(242, 242, 242, 1)";
    	document.getElementById("image").src = "img/mines.png";
    	document.getElementById('description').innerHTML = "Self-supplied water use for mining in millions of gallons of water per day.";
    	legend();
    	update();	
    }
    //local government wages by county
    function livestockFunc() {
    	map.removeLayer(water_use);
    	document.getElementById(buttonNumber[data]).style.background = "rgba(242,242,242,0.2)";
    	colors = ['#666600','#959735','#c5ca81','#d8e39c','#f0f4d7'];
    	stateLevels = [2.5, 1, 0.5, 0.25, 1, 0.5, 0.25, 0.1, 2.5, 1, 0.25, 0.1];
    	data = 6;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('description').innerHTML = "Average annual wages for full-time local gov. parks & rec. employees in thousands of dollars";
    	document.getElementById('but7').style.background = "rgba(242, 242, 242, 1)";
    	document.getElementById("image").src = "img/livestock.png";
    	document.getElementById('description').innerHTML = "Self-supplied water use for livestock in millions of gallons of water per day.";
    	legend();
    	update();
    }
    function irrigationFunc() {
    	map.removeLayer(water_use);
    	document.getElementById(buttonNumber[data]).style.background = "rgba(242,242,242,0.2)";
    	colors = ['#006d2c','#31a354','#74c476','#bae4b3','#edf8e9'];
    	stateLevels = [500, 250, 100, 25, 500, 250, 100, 25, 250, 100, 25, 10];
    	data = 7;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('description').innerHTML = "Average annual wages for full-time local gov. parks & rec. employees in thousands of dollars";
    	document.getElementById('but8').style.background = "rgba(242, 242, 242, 1)";
    	document.getElementById("image").src = "img/irrigation.png";
    	document.getElementById('description').innerHTML = "Self-supplied water use for irrigation in millions of gallons of water per day.";
    	legend();
    	update();
    }
    function aquaFunc() {
    	map.removeLayer(water_use);
    	document.getElementById(buttonNumber[data]).style.background = "rgba(242,242,242,0.2)";
    	colors = ['#004d38','#009970','#00cc99','#66ffd9','#ccfff2'];
    	stateLevels = [100, 50, 25, 10, 100, 50, 25, 10, 10, 5, 2.5, 1];
    	data = 8;
    	document.getElementById('title').innerHTML = titleText();
    	document.getElementById('description').innerHTML = "Average annual wages for full-time local gov. parks & rec. employees in thousands of dollars";
    	document.getElementById('but9').style.background = "rgba(242, 242, 242, 1)";
    	document.getElementById("image").src = "img/aqua.png";
    	document.getElementById('description').innerHTML = "Self-supplied water use for aquaculture in millions of gallons of water per day.";
    	legend();
    	update();
    }
    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////
      function legend(){
      	document.getElementById('leg1').innerHTML = stateLevels[dataSelection[0]] + "+";
    	document.getElementById('leg2').innerHTML = stateLevels[dataSelection[1]] + " - " + stateLevels[dataSelection[0]];
    	document.getElementById('leg3').innerHTML = stateLevels[dataSelection[2]] + " - " + stateLevels[dataSelection[1]];
    	document.getElementById('leg4').innerHTML = stateLevels[dataSelection[3]] + " - " + stateLevels[dataSelection[2]];
    	document.getElementById('leg5').innerHTML = "Less than " + stateLevels[dataSelection[3]];
    	
    	document.getElementById('highest').style.background = colors[0];
    	document.getElementById('midhigh').style.background = colors[1];
    	document.getElementById('middle').style.background = colors[2];
    	document.getElementById('midlow').style.background = colors[3];
    	document.getElementById('lowest').style.background = colors[4];
      	
      	resizeMiddle();
      } 
       
   	//add zoom control
    new L.Control.Zoom({ position: 'topright' }).addTo(map);
    
    //remove leaflet attribution
	document.getElementsByClassName("leaflet-control-attribution")[0].style.visibility = "hidden";
	
	//add scrolling capabilities to text box
     var container = document.getElementById('text');
		Ps.initialize(container);
	
	//update text box to be correct size
	var minHeight = 50; // Define a minimum height for the middle div

	function resizeMiddle() {
    var h = $('body').height() - $('#top').height() - 95;
    		h = h > minHeight ? h : minHeight;
   	 	$('#attribution').height(h);
	}

	$(document).ready(resizeMiddle);
	$(window).resize(resizeMiddle);
	
    //remove standard leaflet attribution
    

</script>
</body>
</html>
